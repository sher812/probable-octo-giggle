"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useMediaIndex = void 0;
var react_1 = require("react");
var theme_1 = require("../theme");
function _getMediaQuery(media, index) {
    return index === 0
        ? "(max-width: " + (media[index] - 1) + "px)"
        : "screen and (min-width: " + media[index - 1] + "px) and (max-width: " + (media[index] - 1) + "px)";
}
/**
 * This API might change. DO NOT USE IN PRODUCTION.
 * @beta
 */
function useMediaIndex() {
    var theme = theme_1.useTheme();
    var media = theme.sanity.media;
    // Get initial index
    var _a = react_1.useState(function () {
        if (typeof window !== 'undefined') {
            for (var idx = 0; idx < media.length; idx += 1) {
                var mq = window.matchMedia(_getMediaQuery(media, idx));
                if (mq.matches) {
                    return idx;
                }
            }
        }
        return 0;
    }), index = _a[0], setIndex = _a[1];
    react_1.useEffect(function () {
        var disposeFns = media.map(function (_, idx) {
            var mq = window.matchMedia(_getMediaQuery(media, idx));
            var handleChange = function () {
                if (mq.matches)
                    setIndex(idx);
            };
            mq.addEventListener('change', handleChange);
            return function () {
                mq.removeEventListener('change', handleChange);
            };
        });
        return function () {
            disposeFns.forEach(function (disposeFn) { return disposeFn(); });
        };
    }, [media]);
    return index;
}
exports.useMediaIndex = useMediaIndex;
//# sourceMappingURL=useMediaIndex.js.map